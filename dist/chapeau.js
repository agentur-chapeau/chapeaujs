!function(){function e(e,t,r,n){Object.defineProperty(e,t,{get:r,set:n,enumerable:!0,configurable:!0})}var t,r,n,o="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},i={},a={},l=o.parcelRequirec7c1;null==l&&((l=function(e){if(e in i)return i[e].exports;if(e in a){var t=a[e];delete a[e];var r={id:e,exports:{}};return i[e]=r,t.call(r.exports,r,r.exports),r.exports}var n=Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}).register=function(e,t){a[e]=t},o.parcelRequirec7c1=l);var s=l.register;function u(e){"loading"===document.readyState?document.addEventListener("DOMContentLoaded",e):e()}s("iE7OH",function(t,r){e(t.exports,"register",function(){return n},function(e){return n=e}),e(t.exports,"resolve",function(){return o},function(e){return o=e});var n,o,i=new Map;n=function(e,t){for(var r=0;r<t.length-1;r+=2)i.set(t[r],{baseUrl:e,path:t[r+1]})},o=function(e){var t=i.get(e);if(null==t)throw Error("Could not resolve bundle with id "+e);return new URL(t.path,t.baseUrl).toString()}}),s("aNJCr",function(t,r){e(t.exports,"getBundleURL",function(){return n},function(e){return n=e});var n,o={};n=function(e){var t=o[e];return t||(t=function(){try{throw Error()}catch(t){var e=(""+t.stack).match(/(https?|file|ftp|(chrome|moz|safari-web)-extension):\/\/[^)\n]+/g);if(e)return(""+e[2]).replace(/^((?:https?|file|ftp|(chrome|moz|safari-web)-extension):\/\/.+)\/[^/]+$/,"$1")+"/"}return"/"}(),o[e]=t),t}}),s("iTpjr",function(e,t){e.exports=Promise.all([l("5FrBL")(l("iE7OH").resolve("iP3Dz")),l("4WKyX")(l("iE7OH").resolve("8a5ff"))]).then(()=>l("eIiHr"))}),s("5FrBL",function(e,t){var r=l("2prpb");e.exports=r(function(e){return new Promise(function(t,r){if([].concat(document.getElementsByTagName("link")).some(function(t){return t.href===e&&t.rel.indexOf("stylesheet")>-1})){t();return}var n=document.createElement("link");n.rel="stylesheet",n.href=e,n.onerror=function(e){n.onerror=n.onload=null,n.remove(),r(e)},n.onload=function(){n.onerror=n.onload=null,t()},document.getElementsByTagName("head")[0].appendChild(n)})})}),s("2prpb",function(e,t){var r={},n={},o={};e.exports=function(e,t){return function(i){var a=function(e){switch(e){case"preload":return n;case"prefetch":return o;default:return r}}(t);return a[i]?a[i]:a[i]=e.apply(null,arguments).catch(function(e){throw delete a[i],e})}}}),s("4WKyX",function(e,t){var r=l("2prpb");e.exports=r(function(e){return new Promise(function(t,r){if([].concat(document.getElementsByTagName("script")).some(function(t){return t.src===e})){t();return}var n=document.createElement("link");n.href=e,n.rel="preload",n.as="script",document.head.appendChild(n);var o=document.createElement("script");o.async=!0,o.type="text/javascript",o.src=e,o.onerror=function(t){var n=TypeError("Failed to fetch dynamically imported module: ".concat(e,". Error: ").concat(t.message));o.onerror=o.onload=null,o.remove(),r(n)},o.onload=function(){o.onerror=o.onload=null,t()},document.getElementsByTagName("head")[0].appendChild(o)})})}),l("iE7OH").register(l("aNJCr").getBundleURL("EVgbq"),JSON.parse('["EVgbq","chapeau.js","8a5ff","filepond.8361a518.js","iP3Dz","filepond.928feff9.css","87GoE","chapeau.css"]'));var c=Array.isArray,f="object"==typeof o&&o&&o.Object===Object&&o,d="object"==typeof self&&self&&self.Object===Object&&self,h=f||d||Function("return this")(),p=h.Symbol,m=Object.prototype,b=m.hasOwnProperty,y=m.toString,g=p?p.toStringTag:void 0,v=function(e){var t=b.call(e,g),r=e[g];try{e[g]=void 0;var n=!0}catch(e){}var o=y.call(e);return n&&(t?e[g]=r:delete e[g]),o},_=Object.prototype.toString,F=p?p.toStringTag:void 0,S=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":F&&F in Object(e)?v(e):_.call(e)},w=function(e){return"symbol"==typeof e||null!=e&&"object"==typeof e&&"[object Symbol]"==S(e)},x=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,E=/^\w*$/,T=function(e,t){if(c(e))return!1;var r=typeof e;return!!("number"==r||"symbol"==r||"boolean"==r||null==e||w(e))||E.test(e)||!x.test(e)||null!=t&&e in Object(t)},P=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)},j=function(e){if(!P(e))return!1;var t=S(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t},z=h["__core-js_shared__"],O=(t=/[^.]+$/.exec(z&&z.keys&&z.keys.IE_PROTO||""))?"Symbol(src)_1."+t:"",A=Function.prototype.toString,H=function(e){if(null!=e){try{return A.call(e)}catch(e){}try{return e+""}catch(e){}}return""},B=/^\[object .+?Constructor\]$/,L=Object.prototype,C=Function.prototype.toString,k=L.hasOwnProperty,I=RegExp("^"+C.call(k).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),M=function(e,t){var r,n=null==e?void 0:e[t];return P(r=n)&&(!O||!(O in r))&&(j(r)?I:B).test(H(r))?n:void 0},R=M(Object,"create"),U=Object.prototype.hasOwnProperty,D=Object.prototype.hasOwnProperty;function N(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}N.prototype.clear=function(){this.__data__=R?R(null):{},this.size=0},N.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},N.prototype.get=function(e){var t=this.__data__;if(R){var r=t[e];return"__lodash_hash_undefined__"===r?void 0:r}return U.call(t,e)?t[e]:void 0},N.prototype.has=function(e){var t=this.__data__;return R?void 0!==t[e]:D.call(t,e)},N.prototype.set=function(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=R&&void 0===t?"__lodash_hash_undefined__":t,this};var $=function(e,t){return e===t||e!=e&&t!=t},q=function(e,t){for(var r=e.length;r--;)if($(e[r][0],t))return r;return -1},G=Array.prototype.splice;function V(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}V.prototype.clear=function(){this.__data__=[],this.size=0},V.prototype.delete=function(e){var t=this.__data__,r=q(t,e);return!(r<0)&&(r==t.length-1?t.pop():G.call(t,r,1),--this.size,!0)},V.prototype.get=function(e){var t=this.__data__,r=q(t,e);return r<0?void 0:t[r][1]},V.prototype.has=function(e){return q(this.__data__,e)>-1},V.prototype.set=function(e,t){var r=this.__data__,n=q(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this};var W=M(h,"Map"),J=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e},K=function(e,t){var r=e.__data__;return J(t)?r["string"==typeof t?"string":"hash"]:r.map};function X(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function Y(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw TypeError("Expected a function");var r=function(){var n=arguments,o=t?t.apply(this,n):n[0],i=r.cache;if(i.has(o))return i.get(o);var a=e.apply(this,n);return r.cache=i.set(o,a)||i,a};return r.cache=new(Y.Cache||X),r}X.prototype.clear=function(){this.size=0,this.__data__={hash:new N,map:new(W||V),string:new N}},X.prototype.delete=function(e){var t=K(this,e).delete(e);return this.size-=t?1:0,t},X.prototype.get=function(e){return K(this,e).get(e)},X.prototype.has=function(e){return K(this,e).has(e)},X.prototype.set=function(e,t){var r=K(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this},Y.Cache=X;var Q=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Z=/\\(\\)?/g,ee=(n=(r=Y(function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(Q,function(e,r,n,o){t.push(n?o.replace(Z,"$1"):r||e)}),t},function(e){return 500===n.size&&n.clear(),e})).cache,r),et=function(e,t){for(var r=-1,n=null==e?0:e.length,o=Array(n);++r<n;)o[r]=t(e[r],r,e);return o},er=1/0,en=p?p.prototype:void 0,eo=en?en.toString:void 0,ei=function e(t){if("string"==typeof t)return t;if(c(t))return et(t,e)+"";if(w(t))return eo?eo.call(t):"";var r=t+"";return"0"==r&&1/t==-er?"-0":r},ea=function(e,t){return c(e)?e:T(e,t)?[e]:ee(null==e?"":ei(e))},el=1/0,es=function(e){if("string"==typeof e||w(e))return e;var t=e+"";return"0"==t&&1/e==-el?"-0":t},eu=function(e,t){t=ea(t,e);for(var r=0,n=t.length;null!=e&&r<n;)e=e[es(t[r++])];return r&&r==n?e:void 0},ec=function(e,t,r){var n=null==e?void 0:eu(e,t);return void 0===n?r:n},ef=function(){try{var e=M(Object,"defineProperty");return e({},"",{}),e}catch(e){}}(),ed=function(e,t,r){"__proto__"==t&&ef?ef(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r},eh=Object.prototype.hasOwnProperty,ep=function(e,t,r){var n=e[t];eh.call(e,t)&&$(n,r)&&(void 0!==r||t in e)||ed(e,t,r)},em=/^(?:0|[1-9]\d*)$/,eb=function(e,t){var r=typeof e;return!!(t=null==t?0x1fffffffffffff:t)&&("number"==r||"symbol"!=r&&em.test(e))&&e>-1&&e%1==0&&e<t},ey=function(e,t,r,n){if(!P(e))return e;t=ea(t,e);for(var o=-1,i=t.length,a=i-1,l=e;null!=l&&++o<i;){var s=es(t[o]),u=r;if("__proto__"===s||"constructor"===s||"prototype"===s)break;if(o!=a){var c=l[s];void 0===(u=n?n(c,s,l):void 0)&&(u=P(c)?c:eb(t[o+1])?[]:{})}ep(l,s,u),l=l[s]}return e};class eg{constructor(e){if(e.dataset.refAsyncForm)return eg.refs[e.dataset.refAsyncForm];this.ref=Math.random(),eg.refs[this.ref]=this,e.dataset.refAsyncForm=this.ref,this.el=e,this.form=e.querySelector("form"),this.formSuccess=e.querySelector(".w-form-done"),this.formFail=e.querySelector(".w-form-fail"),this.submitButton=e.querySelector('[type="submit"]'),this.buttonText=this.getSubmitText(),this.waitingText=this.submitButton.dataset.wait,this.beforeSubmitHandlers=[],this.payloadHandlers=[],this.inputHandlers=[],this.onStateHandlers=[],this.el.addEventListener("submit",e=>this.submit(e))}set onBeforeSubmit(e){this.beforeSubmitHandlers.push(e)}set onPayload(e){this.payloadHandlers.push(e)}set onInput(e){this.inputHandlers.push(e)}set onState(e){this.onStateHandlers.push(e)}async submit(e){e.preventDefault();try{if(!this.beforeSubmitHandlers.reduce((e,t)=>t()&&e,!0))return;this.setState("loading");let e=await this.createPayload(),t=this.form.action,r={method:this.form.method,headers:{"Content-Type":"application/json"},body:JSON.stringify(e)};(await fetch(t,r)).ok?this.setState("success"):this.setState("error")}catch(e){console.error(e),this.setState("error")}}async createPayload(){let e=this.payloadHandlers.reduce((e,t)=>t(e),{});for(let r of this.elements.filter(e=>""!==e.name)){var t;let n=r.name,o=r.value;for(let e of("checkbox"===r.type&&(o=r.checked),"radio"!==r.type||r.checked||(o=null),this.inputHandlers))o=await e(r,o);if(null===o)continue;let i=[r.dataset.group,n].filter(e=>e),a=ec(e,i);void 0!==a&&(o=[a,o].flat()),t=o,null==e||ey(e,i,t)}return e}setState(e){switch(e){case"loading":this.form.style.display=null,this.formSuccess.style.display=null,this.formFail.style.display=null,this.elements.forEach(e=>e.disabled=!0),this.setSubmitText(this.waitingText);break;case"success":this.form.style.display="none",this.formSuccess.style.display="block",this.formFail.style.display="none",this.elements.forEach(e=>e.disabled=!1),this.setSubmitText(this.buttonText),this.form.reset(),this.formSuccess.scrollIntoView({behavior:"smooth",block:"center"});break;case"error":this.form.style.display=null,this.formSuccess.style.display=null,this.formFail.style.display="block",this.elements.forEach(e=>e.disabled=!1),this.setSubmitText(this.buttonText)}this.onStateHandlers.forEach(t=>t(e))}getSubmitText(){return this.submitButton instanceof HTMLInputElement?this.submitButton.value:this.submitButton.textContent}setSubmitText(e){this.submitButton instanceof HTMLInputElement?this.submitButton.value=e:this.submitButton.textContent=e}get elements(){return Array.from(this.form.elements)}}eg.refs={},window.AsyncForm=eg,u(()=>{Array.from(document.querySelectorAll("[c-async-form]")).forEach(e=>new eg(e))});class ev{constructor(e){if(e.dataset.refFileUpload)return ev.refs[e.dataset.refFileUpload];this.ref=Math.random(),ev.refs[this.ref]=this,e.dataset.refFileUpload=this.ref,this.inputs=e.querySelectorAll('input[type="file"]'),this.fileponds={},this.headers={Authorization:"pFdRC99ihTG!C%BQB6EJKjc!n%"},document.addEventListener("FilePond:loaded",()=>this.onload());let t=new eg(e.closest("[c-async-form]"));t.onBeforeSubmit=()=>this.beforeSubmit(),t.onPayload=e=>this.onPayload(e),t.onInput=async(e,t)=>await this.inputHandler(e,t),l("iTpjr").then(e=>{Object.assign(globalThis,e)})}onload(){FilePond.registerPlugin(FilePondPluginFileValidateType),FilePond.registerPlugin(FilePondPluginFileValidateSize);let e={server:{url:"https://formupload.agentur-chapeau.de/",process:{url:"process",headers:this.headers},revert:{url:"revert",headers:this.headers},restore:null,load:null,fetch:null},credits:!1,...e_,...window.c_fileupload_options};for(let t of this.inputs)this.fileponds[t.name]=FilePond.create(t,{...e,maxFiles:t.dataset.maxFiles||null,maxFileSize:t.dataset.maxFileSize||null,maxTotalFileSize:t.dataset.maxTotalFileSize||null})}beforeSubmit(){for(let[e,t]of Object.entries(this.fileponds))if(!(t.status==FilePond.Status.EMPTY||t.status==FilePond.Status.READY))return alert("Es sind noch nicht alle Dateien hochgeladen!"),!1;return!0}onPayload(e){for(let t of this.inputs)t.multiple&&(e[t.name]=[]);return e}async inputHandler(e,t){if(!e.closest(".filepond--root"))return t;if(!e.closest(".filepond--data"))return null;let r=this.fileponds[e.name],n=r.getFiles().find(e=>e.serverId===t),o=await fetch(`${r.server.url}finish`,{method:"POST",body:t,headers:this.headers});if(!o.ok)throw Error("Upload could not finish ",o);return{url:await o.text(),name:n.filename,size:n.fileSize}}}ev.refs={},window.FileUpload=ev,u(()=>{Array.from(document.querySelectorAll("[c-file-upload]")).forEach(e=>new ev(e))});let e_={labelIdle:`Dateien hierher ziehen oder <span class="filepond--label-action">ausw\xe4hlen</span>`,labelInvalidField:"Feld enthält ungültige Dateien",labelFileWaitingForSize:"Auf Größe warten",labelFileSizeNotAvailable:"Größe nicht verfügbar",labelFileLoading:"Laden",labelFileLoadError:"Fehler beim Laden",labelFileProcessing:"Hochladen",labelFileProcessingComplete:"Hochgeladen",labelFileProcessingAborted:"Hochladen abgebrochen",labelFileProcessingError:"Fehler beim Hochladen",labelFileProcessingRevertError:"Fehler beim Entfernen",labelFileRemoveError:"Fehler beim Löschen",labelTapToCancel:"Tippen zum Abbrechen ",labelTapToRetry:"Tippen zum Wiederholen",labelTapToUndo:"Tippen zum Entfernen",labelButtonRemoveItem:"Entfernen",labelButtonAbortItemLoad:"Abbrechen",labelButtonRetryItemLoad:"Wiederholen",labelButtonAbortItemProcessing:"Abbrechen",labelButtonUndoItemProcessing:"Entfernen",labelButtonRetryItemProcessing:"Wiederholen",labelButtonProcessItem:"Hochladen",labelMaxFileSizeExceeded:"Datei ist zu groß",labelMaxFileSize:"Maximale Dateigröße beträgt {filesize}",labelMaxTotalFileSizeExceeded:"Maximale Gesamtgröße überschritten",labelMaxTotalFileSize:"Maximale Gesamtgröße beträgt {filesize}",labelFileTypeNotAllowed:"Ungültiger Dateityp",fileValidateTypeLabelExpectedTypes:"Gültige Dateitypen: {allButLastType} und {lastType}",fileValidateTypeLabelExpectedTypesMap:{"image/*":"Bilddateien","image/png":".png","image/jpg":".jpg","image/jpeg":".jpeg","application/pdf":".pdf","application/vnd.openxmlformats-officedocument.wordprocessingml.document":".docx"}};window.Chapeau={AsyncForm:eg,FileUpload:ev}}();
//# sourceMappingURL=chapeau.js.map
